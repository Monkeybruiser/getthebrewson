var countCookies=0,totalNames=0,id=0,cookies="",notificationBrewTimer=0,notificationTimer=0,expires="";function clearBrewers(){cookies=document.cookie.split(";");for(var e=0;e<cookies.length;e++)eraseCookie(cookies[e].split("=")[0]);id=1,countCookies=totalNames=0,$.cookie("brewer_total",totalNames),$.cookie("brewer_existing",countCookies)}function eraseCookie(e){createCookie(e,"",-1)}function createCookie(e,t,o){if(o){var i=new Date;i.setTime(i.getTime()+24*o*60*60*1e3),expires="; expires="+i.toGMTString()}else expires="";document.cookie=e+"="+t+expires+"; path=/"}function rollForBrewer(){jQuery(".countdown").hasClass("visible")&&jQuery(".countdown").removeClass("visible"),jQuery(".kettle--outer").hasClass("hidden")?(jQuery(".brew--action").addClass("push"),setTimeout(function(){jQuery(".kettle").addClass("fall-in"),jQuery(".kettle--outer").removeClass("hidden")},500),setTimeout(function(){getBrewer()},1e3),setTimeout(function(){jQuery(".kettle").removeClass("fall-in")},2e3)):(jQuery(".kettle").removeClass("boiled"),jQuery(".kettle--name--wrap").removeClass("show"),getBrewer())}function getBrewer(){jQuery(".brew-list").addClass("brew-list__active"),jQuery(".brew-list li").removeClass("itsme");var e=jQuery(".brew-list li").toArray(),t=e.length,o=e[Math.floor(Math.random()*t)],i=jQuery(o).find(".option--name").text();jQuery(location).attr("href");jQuery(o).addClass("itsme"),setTimeout(function(){jQuery(".kettle--name").text(i)},500),setTimeout(function(){jQuery(".kettle").addClass("boiling")},2e3),setTimeout(function(){jQuery(".kettle").addClass("boiled"),initCountdownTimer()},4e3),setTimeout(function(){jQuery(".kettle--name--wrap").addClass("show"),0<notificationBrewTimer&&jQuery(".countdown").addClass("visible")},6e3)}function initCountdownTimer(){if(0<(notificationBrewTimer=jQuery("#countdownVal").val())){notificationTimer=notificationBrewTimer+":00";var i=setInterval(function(){var e=notificationTimer.split(":"),t=parseInt(e[0],10),o=parseInt(e[1],10);t=--o<0?--t:t,o=(o=o<0?59:o)<10?"0"+o:o,jQuery(".countdown--timer span").html(t+":"+o),notificationTimer=t+":"+o,0===t&&1===o&&(notificationPopup(),clearInterval(i))},1e3)}}function notificationPopup(){if("granted"!==Notification.permission)Notification.requestPermission();else new Notification("Time's up dude!",{icon:"http://www.getthebrewson.co.uk/library/images/img-notification-tile.png",body:"It's someone elses turn to make the brews. Click to give it another spin!"});jQuery(".countdown").removeClass("visible")}jQuery(document).ready(function(t){t(".add-name").submit(function(e){e.preventDefault()}),"NaN"==(countCookies=t.cookie("brewer_existing"))&&(countCookies=0),totalNames=t(".brew-list li").length,id=countCookies++;var e=document.getElementById("addBrewer"),o=document.getElementById("dataInput"),i=document.getElementById("brewList");e.onclick=function(){t.cookie("brewer_number_"+id,o.value),t.cookie("brewer_total",totalNames),t.cookie("brewer_existing",countCookies),i.innerHTML+='<li class="option option-'+id+'" data-name="brewer_number_'+id+'"><span class="option--name">'+o.value+'</span> <span class="option--delete">Remove this name</span></li>'},t("#addBrewer").click(function(){id++,1<t(".brew-list li").length&&t("#brews").addClass("brewme"),t("#dataInput").val(""),totalNames++,countCookies++,t.cookie("brewer_total",totalNames),t.cookie("brewer_existing",countCookies)}),t("#brews").click(function(){rollForBrewer()}),t("#clearbrewers").click(function(){clearBrewers(),t(".brew-list").empty()}),t("#reRoll").click(function(){rollForBrewer()}),t("body").on("click",".option--delete",function(){t(this).closest(".option").slideUp("fast");var e=t(this).closest(".option");setTimeout(function(){t(e).remove()},1200),eraseCookie(t(this).closest(".option").data("name")),totalNames--,t.cookie("brewer_total",totalNames)}),document.addEventListener("DOMContentLoaded",function(){"granted"!==Notification.permission&&Notification.requestPermission()})});